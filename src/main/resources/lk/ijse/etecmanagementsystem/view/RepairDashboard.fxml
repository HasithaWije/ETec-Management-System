<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.shape.Line?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="750.0" prefWidth="1100.0" style="-fx-background-color: #F1F5F9;" xmlns="http://javafx.com/javafx/19" xmlns:fx="http://javafx.com/fxml/1" fx:controller="lk.ijse.demo1.controller.RepairController">
    <children>
        <VBox spacing="15.0" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
            <padding>
                <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
            </padding>
            <children>
                <!-- HEADER -->
                <HBox alignment="CENTER_LEFT" spacing="15.0">
                    <Label text="Repair Management" textFill="#0f172a">
                        <font><Font name="System Bold" size="24.0" /></font>
                    </Label>
                    <Pane HBox.hgrow="ALWAYS" />
                    <Button onAction="#handleNewTicket" style="-fx-background-color: #3B82F6; -fx-text-fill: white; -fx-cursor: hand; -fx-font-weight: bold; -fx-background-radius: 6;" text="+ New Repair Ticket">
                        <padding><Insets top="10" right="20" bottom="10" left="20"/></padding>
                    </Button>
                </HBox>

                <SplitPane dividerPositions="0.3" style="-fx-background-color: transparent;" VBox.vgrow="ALWAYS">
                    <items>
                        <!-- LEFT: LIST -->
                        <VBox spacing="10.0">
                            <TextField fx:id="searchField" promptText="Search jobs..." style="-fx-background-color: white; -fx-border-color: #CBD5E1; -fx-padding: 8; -fx-background-radius: 6;" />
                            <ListView fx:id="jobListView" style="-fx-background-color: transparent; -fx-border-color: transparent;" VBox.vgrow="ALWAYS" />
                        </VBox>

                        <!-- RIGHT: DETAILS -->
                        <ScrollPane fitToWidth="true" style="-fx-background: #F1F5F9; -fx-border-color: transparent;">
                            <content>
                                <VBox fx:id="detailContainer" spacing="15.0" visible="false">
                                    <padding><Insets bottom="10" left="10" right="10" top="5" /></padding>

                                    <!-- PIPELINE VISUALIZATION -->
                                    <HBox alignment="CENTER" spacing="0.0" style="-fx-padding: 20 0;">
                                        <VBox alignment="CENTER" spacing="5"><Circle fx:id="cPending" fill="#cbd5e1" radius="10" /><Label text="Pending" textFill="#64748b"><font><Font size="10" /></font></Label></VBox>
                                        <Line fx:id="l1" endX="50" stroke="#cbd5e1" strokeWidth="3" />
                                        <VBox alignment="CENTER" spacing="5"><Circle fx:id="cDiagnosis" fill="#cbd5e1" radius="10" /><Label text="Diagnosis" textFill="#64748b"><font><Font size="10" /></font></Label></VBox>
                                        <Line fx:id="l2" endX="50" stroke="#cbd5e1" strokeWidth="3" />
                                        <VBox alignment="CENTER" spacing="5"><Circle fx:id="cRepair" fill="#cbd5e1" radius="10" /><Label text="In Repair" textFill="#64748b"><font><Font size="10" /></font></Label></VBox>
                                        <Line fx:id="l3" endX="50" stroke="#cbd5e1" strokeWidth="3" />
                                        <VBox alignment="CENTER" spacing="5"><Circle fx:id="cReady" fill="#cbd5e1" radius="10" /><Label text="Ready" textFill="#64748b"><font><Font size="10" /></font></Label></VBox>
                                    </HBox>

                                    <!-- DETAILS CARDS -->
                                    <HBox spacing="15.0">
                                        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 5, 0, 0, 0);" HBox.hgrow="ALWAYS">
                                            <Label text="DEVICE" textFill="#94a3b8"><font><Font name="System Bold" size="10" /></font></Label>
                                            <Label fx:id="lblDevice" text="Device Name" textFill="#0f172a"><font><Font name="System Bold" size="16" /></font></Label>
                                            <Label fx:id="lblSN" text="SN: 12345" textFill="#64748b" />
                                        </VBox>
                                        <VBox style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 5, 0, 0, 0);" HBox.hgrow="ALWAYS">
                                            <Label text="CUSTOMER" textFill="#94a3b8"><font><Font name="System Bold" size="10" /></font></Label>
                                            <Label fx:id="lblCustomer" text="Customer Name" textFill="#0f172a"><font><Font name="System Bold" size="16" /></font></Label>
                                            <Label fx:id="lblPhone" text="Phone Number" textFill="#64748b" />
                                        </VBox>
                                    </HBox>

                                    <!-- NOTES SECTION -->
                                    <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 5, 0, 0, 0);">
                                        <Label text="1. Customer Issue" textFill="#64748b" />
                                        <TextArea fx:id="txtProblem" editable="false" prefHeight="50" wrapText="true" style="-fx-background-color: #F8FAFC; -fx-border-color: #e2e8f0;" />

                                        <Label text="2. Technician Diagnosis" textFill="#64748b" />
                                        <TextArea fx:id="txtDiagnosis" prefHeight="50" promptText="Enter diagnosis details..." wrapText="true" style="-fx-border-color: #e2e8f0;"/>

                                        <Label text="3. Completion Note" textFill="#64748b" />
                                        <TextArea fx:id="txtCompletion" prefHeight="50" promptText="What was fixed?" wrapText="true" style="-fx-border-color: #e2e8f0;"/>
                                    </VBox>

                                    <!-- FINANCIALS -->
                                    <VBox spacing="10" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 15; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.05), 5, 0, 0, 0);">
                                        <HBox alignment="CENTER_LEFT" spacing="10">
                                            <Label text="Parts &amp; Labor" textFill="#0f172a"><font><Font name="System Bold" size="14" /></font></Label>
                                            <Pane HBox.hgrow="ALWAYS" />
                                            <TextField fx:id="txtNewPartName" promptText="Part Name" style="-fx-background-color: #f1f5f9; -fx-border-color: #e2e8f0;"/>
                                            <TextField fx:id="txtNewPartPrice" prefWidth="80" promptText="Price" style="-fx-background-color: #f1f5f9; -fx-border-color: #e2e8f0;"/>
                                            <Button onAction="#handleAddPart" text="Add" style="-fx-background-color: #EEF2FF; -fx-text-fill: #4F46E5; -fx-cursor: hand;" />
                                        </HBox>
                                        <TableView fx:id="partsTable" prefHeight="120" style="-fx-background-color: white; -fx-border-color: #e2e8f0;">
                                            <columns>
                                                <TableColumn fx:id="colPartName" text="Item" prefWidth="200"/>
                                                <TableColumn fx:id="colPartPrice" text="Price" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                        <HBox alignment="CENTER_RIGHT" spacing="10">
                                            <Label text="Labor Cost: $" />
                                            <TextField fx:id="txtLabor" prefWidth="80" text="0.00" style="-fx-alignment: center-right; -fx-background-color: #f1f5f9; -fx-border-color: #e2e8f0;"/>
                                        </HBox>
                                        <HBox alignment="CENTER_RIGHT" spacing="10">
                                            <Label text="Grand Total:" textFill="#0f172a"><font><Font size="16" /></font></Label>
                                            <Label fx:id="lblTotal" text="0.00" textFill="#2563eb"><font><Font name="System Bold" size="18" /></font></Label>
                                        </HBox>
                                    </VBox>

                                    <!-- ACTION BAR -->
                                    <HBox alignment="CENTER_RIGHT" spacing="15" style="-fx-padding: 10 0 30 0;">
                                        <Label fx:id="lblPaymentStatus" text="Payment Pending" textFill="#94a3b8"><font><Font name="System Bold" size="12"/></font></Label>
                                        <Pane HBox.hgrow="ALWAYS"/>
                                        <Button fx:id="btnSave" onAction="#handleSave" text="Save Changes" style="-fx-background-color: white; -fx-border-color: #cbd5e1; -fx-text-fill: #334155; -fx-cursor: hand;" />
                                        <Button fx:id="btnNextStatus" onAction="#handleNextStatus" text="Proceed to Next Step" style="-fx-background-color: #3b82f6; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand;" />
                                        <Button fx:id="btnCheckout" onAction="#handleCheckout" text="Checkout / Deliver" style="-fx-background-color: #10b981; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand;" visible="false" />
                                        <Button fx:id="btnUnclaimed" onAction="#handleUnclaimed" text="Mark Unclaimed" style="-fx-background-color: #ef4444; -fx-text-fill: white; -fx-cursor: hand;" visible="false" />
                                    </HBox>

                                </VBox>
                            </content>
                        </ScrollPane>
                    </items>
                </SplitPane>
            </children>
        </VBox>
    </children>
</AnchorPane>